# フィットネススタジオ管理システム 詳細設計書（最小粒度版）

## 1. コンポーネント設計

### 1.1 コンポーネント一覧
- TodayLessonsPage: 本日のレッスン一覧ページ
- LessonSearch: レッスン検索フォーム
- LessonList: レッスン一覧テーブル
- AttendeeList: 参加者一覧テーブル
- StatusBadge: ステータス表示バッジ
- Pagination: ページネーション制御

### 1.2 主要コンポーネントの入出力と状態

#### TodayLessonsPage
- 入力: なし（静的JSONデータ）
- 出力: 画面表示、子コンポーネント呼び出し
- 状態: 
  - `lessons`: レッスンデータ配列
  - `attendees`: 参加者データマップ
  - `filteredLessons`: フィルタリング後レッスン配列
  - `searchKeyword`: 検索ワード
  - `currentPage`: 現在ページ番号
  - `expandedLessonId`: 展開中レッスンID
  - `loading`: データロード中フラグ

#### LessonSearch
- 入力: 検索コールバック関数、初期キーワード
- 出力: 検索実行イベント
- 状態: 
  - `keyword`: 入力中キーワード

#### LessonList
- 入力: レッスンデータ配列、参加者データマップ、展開中ID、展開切替コールバック
- 出力: 顧客一覧クリックイベント
- 状態: なし（親から受け取るのみ）

#### AttendeeList
- 入力: 参加者データ配列
- 出力: なし
- 状態: なし（表示のみ）

#### StatusBadge
- 入力: ステータス値
- 出力: なし
- 状態: なし（表示のみ）

#### Pagination
- 入力: 現在ページ、総ページ数、ページ変更コールバック
- 出力: ページ変更イベント
- 状態: なし（親から受け取るのみ）

## 2. 主要データフロー

1. ページロード → JSONデータ読み込み → レッスン一覧表示
2. 検索入力 → レッスンフィルタリング → 結果表示
3. 顧客一覧クリック → 参加者データ取得 → 参加者一覧表示
4. ページ切替 → 表示ページ更新 → レッスン一覧再表示

## 3. 主要状態遷移

### 検索状態遷移
- 初期状態 → 検索中 → 検索結果表示（結果あり/なし）

### 参加者一覧表示状態遷移
- 閉じた状態 → 特定レッスンの参加者一覧表示 → 閉じた状態
- 別レッスンの参加者一覧表示 → 新しいレッスンの参加者一覧表示

### ページネーション状態遷移
- 1ページ目 → 中間ページ → 最終ページ
- 検索実行時は1ページ目に強制リセット

## 4. 主要型定義

```typescript
// レッスンのステータス型
type LessonStatus = 'ongoing' | 'accepting' | 'full';

// レッスンの型定義
interface Lesson {
  id: string;
  time: string;
  name: string;
  instructor: string;
  capacity: number;
  reserved: number;
  status: LessonStatus;
}

// 会員種別の型
type MembershipType = 'gold' | 'platinum' | 'standard' | 'trial';

// 予約ステータスの型
type AttendeeStatus = 'reserved' | 'attended';

// 参加者の型定義
interface Attendee {
  id: string;
  name: string;
  photoUrl?: string;
  membershipType: MembershipType;
  status: AttendeeStatus;
  ticketInfo: string;
}
```
